var ht=Object.defineProperty;var ut=(n,e,t)=>e in n?ht(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Q=(n,e,t)=>(ut(n,typeof e!="symbol"?e+"":e,t),t);function te(){import("data:text/javascript,")}const pt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}};pt();const L={routes:{index:"/",search:"/search?q=:search",cart:"/cart",book:"/book/:book"},search:{types:{book:"book",cart:"cart"}},lists:{types:{book:"book",cart:"cart"}}};function dt(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Z={};(function(n){var e=function(){var t=function(f,s,r,c){for(r=r||{},c=f.length;c--;r[f[c]]=s);return r},o=[1,9],i=[1,10],a=[1,11],l=[1,12],p=[5,11,12,13,14,15],y={trace:function(){},yy:{},symbols_:{error:2,root:3,expressions:4,EOF:5,expression:6,optional:7,literal:8,splat:9,param:10,"(":11,")":12,LITERAL:13,SPLAT:14,PARAM:15,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"(",12:")",13:"LITERAL",14:"SPLAT",15:"PARAM"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,1],[6,1],[7,3],[8,1],[9,1],[10,1]],performAction:function(s,r,c,u,h,d,D){var _=d.length-1;switch(h){case 1:return new u.Root({},[d[_-1]]);case 2:return new u.Root({},[new u.Literal({value:""})]);case 3:this.$=new u.Concat({},[d[_-1],d[_]]);break;case 4:case 5:this.$=d[_];break;case 6:this.$=new u.Literal({value:d[_]});break;case 7:this.$=new u.Splat({name:d[_]});break;case 8:this.$=new u.Param({name:d[_]});break;case 9:this.$=new u.Optional({},[d[_-1]]);break;case 10:this.$=s;break;case 11:case 12:this.$=s.slice(1);break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:8,11:o,13:i,14:a,15:l},{1:[3]},{5:[1,13],6:14,7:5,8:6,9:7,10:8,11:o,13:i,14:a,15:l},{1:[2,2]},t(p,[2,4]),t(p,[2,5]),t(p,[2,6]),t(p,[2,7]),t(p,[2,8]),{4:15,6:4,7:5,8:6,9:7,10:8,11:o,13:i,14:a,15:l},t(p,[2,10]),t(p,[2,11]),t(p,[2,12]),{1:[2,1]},t(p,[2,3]),{6:14,7:5,8:6,9:7,10:8,11:o,12:[1,16],13:i,14:a,15:l},t(p,[2,9])],defaultActions:{3:[2,2],13:[2,1]},parseError:function(s,r){if(r.recoverable)this.trace(s);else{let c=function(u,h){this.message=u,this.hash=h};throw c.prototype=Error,new c(s,r)}},parse:function(s){var r=this,c=[0],u=[null],h=[],d=this.table,D="",_=0,G=0,rt=2,K=1,at=h.slice.call(arguments,1),b=Object.create(this.lexer),A={yy:{}};for(var F in this.yy)Object.prototype.hasOwnProperty.call(this.yy,F)&&(A.yy[F]=this.yy[F]);b.setInput(s,A.yy),A.yy.lexer=b,A.yy.parser=this,typeof b.yylloc=="undefined"&&(b.yylloc={});var H=b.yylloc;h.push(H);var ct=b.options&&b.options.ranges;typeof A.yy.parseError=="function"?this.parseError=A.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var lt=function(){var S;return S=b.lex()||K,typeof S!="number"&&(S=r.symbols_[S]||S),S},k,C,w,U,E={},q,v,W,$;;){if(C=c[c.length-1],this.defaultActions[C]?w=this.defaultActions[C]:((k===null||typeof k=="undefined")&&(k=lt()),w=d[C]&&d[C][k]),typeof w=="undefined"||!w.length||!w[0]){var z="";$=[];for(q in d[C])this.terminals_[q]&&q>rt&&$.push("'"+this.terminals_[q]+"'");b.showPosition?z="Parse error on line "+(_+1)+`:
`+b.showPosition()+`
Expecting `+$.join(", ")+", got '"+(this.terminals_[k]||k)+"'":z="Parse error on line "+(_+1)+": Unexpected "+(k==K?"end of input":"'"+(this.terminals_[k]||k)+"'"),this.parseError(z,{text:b.match,token:this.terminals_[k]||k,line:b.yylineno,loc:H,expected:$})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+C+", token: "+k);switch(w[0]){case 1:c.push(k),u.push(b.yytext),h.push(b.yylloc),c.push(w[1]),k=null,G=b.yyleng,D=b.yytext,_=b.yylineno,H=b.yylloc;break;case 2:if(v=this.productions_[w[1]][1],E.$=u[u.length-v],E._$={first_line:h[h.length-(v||1)].first_line,last_line:h[h.length-1].last_line,first_column:h[h.length-(v||1)].first_column,last_column:h[h.length-1].last_column},ct&&(E._$.range=[h[h.length-(v||1)].range[0],h[h.length-1].range[1]]),U=this.performAction.apply(E,[D,G,_,A.yy,w[1],u,h].concat(at)),typeof U!="undefined")return U;v&&(c=c.slice(0,-1*v*2),u=u.slice(0,-1*v),h=h.slice(0,-1*v)),c.push(this.productions_[w[1]][0]),u.push(E.$),h.push(E._$),W=d[c[c.length-2]][c[c.length-1]],c.push(W);break;case 3:return!0}}return!0}},g=function(){var f={EOF:1,parseError:function(r,c){if(this.yy.parser)this.yy.parser.parseError(r,c);else throw new Error(r)},setInput:function(s,r){return this.yy=r||this.yy||{},this._input=s,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var s=this._input[0];this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s;var r=s.match(/(?:\r\n?|\n).*/g);return r?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),s},unput:function(s){var r=s.length,c=s.split(/(?:\r\n?|\n)/g);this._input=s+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-r),this.offset-=r;var u=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var h=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===u.length?this.yylloc.first_column:0)+u[u.length-c.length].length-c[0].length:this.yylloc.first_column-r},this.options.ranges&&(this.yylloc.range=[h[0],h[0]+this.yyleng-r]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(s){this.unput(this.match.slice(s))},pastInput:function(){var s=this.matched.substr(0,this.matched.length-this.match.length);return(s.length>20?"...":"")+s.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var s=this.match;return s.length<20&&(s+=this._input.substr(0,20-s.length)),(s.substr(0,20)+(s.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var s=this.pastInput(),r=new Array(s.length+1).join("-");return s+this.upcomingInput()+`
`+r+"^"},test_match:function(s,r){var c,u,h;if(this.options.backtrack_lexer&&(h={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(h.yylloc.range=this.yylloc.range.slice(0))),u=s[0].match(/(?:\r\n?|\n).*/g),u&&(this.yylineno+=u.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:u?u[u.length-1].length-u[u.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+s[0].length},this.yytext+=s[0],this.match+=s[0],this.matches=s,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(s[0].length),this.matched+=s[0],c=this.performAction.call(this,this.yy,this,r,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),c)return c;if(this._backtrack){for(var d in h)this[d]=h[d];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var s,r,c,u;this._more||(this.yytext="",this.match="");for(var h=this._currentRules(),d=0;d<h.length;d++)if(c=this._input.match(this.rules[h[d]]),c&&(!r||c[0].length>r[0].length)){if(r=c,u=d,this.options.backtrack_lexer){if(s=this.test_match(c,h[d]),s!==!1)return s;if(this._backtrack){r=!1;continue}else return!1}else if(!this.options.flex)break}return r?(s=this.test_match(r,h[u]),s!==!1?s:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return r||this.lex()},begin:function(r){this.conditionStack.push(r)},popState:function(){var r=this.conditionStack.length-1;return r>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(r){return r=this.conditionStack.length-1-Math.abs(r||0),r>=0?this.conditionStack[r]:"INITIAL"},pushState:function(r){this.begin(r)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(r,c,u,h){switch(u){case 0:return"(";case 1:return")";case 2:return"SPLAT";case 3:return"PARAM";case 4:return"LITERAL";case 5:return"LITERAL";case 6:return"EOF"}},rules:[/^(?:\()/,/^(?:\))/,/^(?:\*+\w+)/,/^(?::+\w+)/,/^(?:[\w%\-~\n]+)/,/^(?:.)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6],inclusive:!0}}};return f}();y.lexer=g;function m(){this.yy={}}return m.prototype=y,y.Parser=m,new m}();typeof dt!="undefined"&&(n.parser=e,n.Parser=e.Parser,n.parse=function(){return e.parse.apply(e,arguments)})})(Z);function P(n){return function(e,t){return{displayName:n,props:e,children:t||[]}}}var tt={Root:P("Root"),Concat:P("Concat"),Literal:P("Literal"),Splat:P("Splat"),Param:P("Param"),Optional:P("Optional")},et=Z.parser;et.yy=tt;var ft=et,mt=Object.keys(tt);function yt(n){return mt.forEach(function(e){if(typeof n[e]=="undefined")throw new Error("No handler defined for "+e.displayName)}),{visit:function(e,t){return this.handlers[e.displayName].call(this,e,t)},handlers:n}}var nt=yt,gt=nt,bt=/[\-{}\[\]+?.,\\\^$|#\s]/g;function ot(n){this.captures=n.captures,this.re=n.re}ot.prototype.match=function(n){var e=this.re.exec(n),t={};if(!!e)return this.captures.forEach(function(o,i){typeof e[i+1]=="undefined"?t[o]=void 0:t[o]=decodeURIComponent(e[i+1])}),t};var kt=gt({Concat:function(n){return n.children.reduce(function(e,t){var o=this.visit(t);return{re:e.re+o.re,captures:e.captures.concat(o.captures)}}.bind(this),{re:"",captures:[]})},Literal:function(n){return{re:n.props.value.replace(bt,"\\$&"),captures:[]}},Splat:function(n){return{re:"([^?]*?)",captures:[n.props.name]}},Param:function(n){return{re:"([^\\/\\?]+)",captures:[n.props.name]}},Optional:function(n){var e=this.visit(n.children[0]);return{re:"(?:"+e.re+")?",captures:e.captures}},Root:function(n){var e=this.visit(n.children[0]);return new ot({re:new RegExp("^"+e.re+"(?=\\?|$)"),captures:e.captures})}}),_t=kt,wt=nt,vt=wt({Concat:function(n,e){var t=n.children.map(function(o){return this.visit(o,e)}.bind(this));return t.some(function(o){return o===!1})?!1:t.join("")},Literal:function(n){return decodeURI(n.props.value)},Splat:function(n,e){return e[n.props.name]?e[n.props.name]:!1},Param:function(n,e){return e[n.props.name]?e[n.props.name]:!1},Optional:function(n,e){var t=this.visit(n.children[0],e);return t||""},Root:function(n,e){e=e||{};var t=this.visit(n.children[0],e);return t?encodeURI(t):!1}}),xt=vt,At=ft,Ct=_t,Et=xt;I.prototype=Object.create(null);I.prototype.match=function(n){var e=Ct.visit(this.ast),t=e.match(n);return t||!1};I.prototype.reverse=function(n){return Et.visit(this.ast,n)};function I(n){var e;if(this?e=this:e=Object.create(I.prototype),typeof n=="undefined")throw new Error("A route spec is required");return e.spec=n,e.ast=At.parse(n),e}var St=I,Pt=St,O=Pt;function Lt(n={}){return'<list-component title="New" list-type="book"></list-component>'}function Rt(n={}){return'<list-component title="Cart" list-type="cart"></list-component>'}function Tt(n={}){return`<book-detail book="${n.book}"></book-detail>`}function It(n={}){return`<list-component title="Search results for '${n.search}'" search="${n.search}" book="" list-type="book"></list-component>`}const R={Main:new O(L.routes.index),Book:new O(L.routes.book),Search:new O(L.routes.search),Cart:new O(L.routes.cart)},qt=[{route:R.Main,page:Lt},{route:R.Book,page:Tt},{route:R.Search,page:It},{route:R.Cart,page:Rt}],$t=n=>{const e=qt.find(t=>t.route.match(n));if(e){const t=e.route.match(n);return{page:e.page,route:e.route,params:t}}return null},J=n=>{let e="<h1>\u041E\u0448\u0438\u0431\u043A\u0430</h1>";const t=$t(n);t&&(e=t.page(t.params)),document.querySelector("#content").innerHTML=e},N=n=>{window.history.pushState({path:n},n,n),J(n)},Ot=()=>{window.addEventListener("popstate",n=>{J(new URL(window.location.href).pathname)}),document.querySelectorAll('[href^="/"]').forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();const{pathname:t}=new URL(e.target.href);N(t)})}),J(new URL(window.location.href).pathname)};class Bt extends HTMLElement{constructor(){super();Q(this,"onClick",t=>{if(t.preventDefault(),!this.selected){const{pathname:o}=new URL(t.target.href);N(o)}});const t=this.attachShadow({mode:"open"}),o=document.createElement("a"),i=document.createElement("style");this.selected=!1,i.textContent=`
            a {
                padding: 5px;
                margin: 5px 5px 5px 0;
                background-color: #ddd;
                color: #333;
            }
            a:hover {
                background-color: #666;
                color: #eee;
                text-decoration: none;
            }
        `,t.appendChild(i),t.appendChild(o)}connectedCallback(){const t=this.shadowRoot,o=this.getAttribute("href"),i=t.querySelector("a");i.href=o,i.textContent=this.getAttribute("text"),i.addEventListener("click",this.onClick)}static get observedAttributes(){return["selected"]}attributeChangedCallback(t,o,i){t==="selected"&&this.updateStyle(JSON.parse(i))}updateStyle(t){if(t){const i=this.shadowRoot.querySelector("style");this.selected=!0,i.textContent=`
                a {
                    padding: 5px;
                    margin: 5px 5px 5px 0;
                    background-color: #4f4f4f;
                    text-decoration: none;
                    color: #ccc;
                    cursor: default;
                }
            `}}}customElements.define("nav-link",Bt);const j="https://bookstore-cart.onrender.com",Mt=n=>fetch(j+n).then(e=>{if(e.ok)return e.json();throw new Error}).catch(e=>{console.log(e)}),Nt=(n,e={})=>fetch(j+n,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(t=>{if(t.ok)return t.json();throw new Error}).catch(t=>{console.log(t)}),jt=(n,e={})=>fetch(j+n,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(t=>{if(t.ok)return t.json();throw new Error}).catch(t=>{console.log(t)}),Vt=(n,e={})=>fetch(j+n,{method:"DELETE",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(t=>{if(t.ok)return t.json();throw new Error}).catch(t=>{console.log(t)});var V={get:Mt,post:Nt,put:jt,delete:Vt};const Dt=()=>V.get("/cart"),Ft=(n={})=>V.post("/cart",n),X=(n,e={})=>V.put(`/cart/${n}`,e),Ht=(n,e)=>V.delete(`/cart/${n}`,e);let x,B,T;const M=async()=>{x=[],T=!1,await Dt().then(n=>{B=0,n.forEach(e=>{x.push({bookId:e.bookId,id:e.id,count:e.count}),B++}),[...n]}).catch(n=>console.log(n.message)),T=!0};class Ut extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"}),t=document.createElement("div");t.setAttribute("class","main-menu"),this.links=[{href:L.routes.index,name:"home",class:"home-link"},{href:L.routes.cart,name:"cart",class:"cart-link"}];const o=document.createElement("style");o.textContent=`
            .main-menu {
                display: flex;
                align-items: center;
                padding: 5px;
            } 

            .global-search {
                font-size: 1am;
                border: 1px solid #ccc;
                border-radius: 8px;
                padding: 4px 20px;
                width: 100%;
                margin: 0 50px;
            }

            .global-search:placeholder {
                color: #aaa;
            }
        `,e.appendChild(o),e.appendChild(t);const i=document.createDocumentFragment();this.links.forEach(l=>{const p=document.createElement("nav-link");p.setAttribute("class",`main-link ${l.class}`),p.setAttribute("href",l.href),p.setAttribute("text",l.name),i.appendChild(p)}),t.appendChild(i);const a=document.createElement("input");a.setAttribute("class","global-search"),a.setAttribute("placeholder","search..."),a.addEventListener("keyup",l=>{if(l.stopPropagation,l.key==="Enter"){l.preventDefault();const p=l.target.value,y=R.Search.reverse({search:p});N(y)}}),t.appendChild(a)}updateSearch(){const t=this.shadowRoot.querySelector("input"),o=this.getAttribute("search");t.value=o}async connectedCallback(){const e=this.shadowRoot,t=this.getAttribute("search");if(t){const o=e.querySelector("input");o.value=t}new URL(window.location.href)}static get observedAttributes(){return["search"]}attributeChangedCallback(e,t,o){e==="search"&&this.updateSearch()}}customElements.define("main-nav",Ut);const st=new Map,zt=n=>st.get(n),Y=n=>{st.set(n.isbn13,n)},Jt=()=>fetch("https://api.itbook.store/1.0/new").then(n=>{if(n.ok)return n.json();throw new Error}).catch(n=>{console.log(n)}),it=n=>fetch("https://api.itbook.store/1.0/books/"+n).then(e=>{if(e.ok)return e.json();throw new Error}).catch(e=>{console.log(e)}),Yt=(n,e)=>fetch(`https://api.itbook.store/1.0/search/${n}/${e}`).then(t=>{if(t.ok)return t.json();throw new Error}).catch(t=>{console.log(t)});class Gt extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"}),t=document.createElement("div");t.setAttribute("class","book-detail"),t.innerHTML=`
            <div class="book-detail-container">
                <img class="book-detail-container__cover" alt="book image">
                <h2 class="book-detail-container__title"></h2>
                <p class="book-detail-container__author"></p>
                <p class="book-detail-container__price"></p>
                <p class="book-detail-container__description"></p>
                <div class="book-detail-container__button-container"></div>
                <p class="book-detail-container__publisher"></p>
                <p class="book-detail-container__isbn13"></p>
            </div>
            <list-component class="similars" title="Similar" list-type="book"></list-component>
        `,e.appendChild(t)}async connectedCallback(){this.shadowRoot;const e=this.getAttribute("book");await it(e).then(t=>{Y(t),this.updateBook(t)}).catch(t=>console.log(t))}async updateBook(e){const t=this.shadowRoot,o=this.getAttribute("book"),i=t.querySelector(".similars");i.setAttribute("id",o),i.setAttribute("search",e.title);const a=t.querySelector(".book-detail-container__title");a.textContent=e.title;const l=t.querySelector(".book-detail-container__author");l.textContent=e.authors;const p=t.querySelector(".book-detail-container__price");p.textContent=e.price;const y=t.querySelector(".book-detail-container__description");y.textContent=e.desc;const g=t.querySelector(".book-detail-container__publisher");g.textContent="Publisher:"+e.publisher;const m=t.querySelector(".book-detail-container__isbn13");m.textContent="ISBN13:"+e.isbn13,t.querySelector(".book-detail-container__cover").setAttribute("src",e.image);const s=t.querySelector(".book-detail-container__button-container");if(T){let r="0",c=!1;const u=x.map(d=>d.bookId).indexOf(e.isbn13);u>=0&&(r=x[u].count,c=!0);const h=document.createElement("cart-button");h.setAttribute("count",r),h.setAttribute("id",e.isbn13),h.setAttribute("isAdded",c),s.appendChild(h)}}}customElements.define("book-detail",Gt);class Kt extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"}),t=document.createElement("div");t.setAttribute("class","book-container"),t.innerHTML=`
            <img class="book-container__cover" alt="book image" />
            <h4 class="book-container__title"></h4>
            <p class="book-container__subtitle"></p>
        `,e.appendChild(t)}connectedCallback(){const e=this.shadowRoot,t=this.getAttribute("id");let o=this.getAttribute("isAdded")||!1;const i=zt(t),a=this.getAttribute("ifCart")||!1;let l=this.getAttribute("count")||"0";const p=e.querySelector(".book-container"),y=e.querySelector(".book-container__cover");y.src=i.image;const g=e.querySelector(".book-container__title");g.textContent=i.title;const m=e.querySelector(".book-container__subtitle");m.textContent=i.subtitle;const f=document.createElement("cart-button");f.setAttribute("count",l),f.setAttribute("id",i.isbn13),f.setAttribute("isAdded",o),f.setAttribute("ifCart",a),f.setAttribute("price",i.price),p.addEventListener("click",s=>{s.stopPropagation();const r=R.Book.reverse({book:t});N(r)}),p.appendChild(f)}}customElements.define("book-component",Kt);class Wt extends HTMLElement{constructor(){super(),this.search="",this.page=1,this.lastPage=1;const e=this.attachShadow({mode:"open"}),t=document.createElement("div");t.setAttribute("class","list-container");const o=document.createElement("h2");o.setAttribute("class","list-title"),e.appendChild(o);const i=document.createElement("style");i.textContent=`
            .list-container {
                margin-bottom: 30px;
            }
        `,e.appendChild(i),e.appendChild(t)}async connectedCallback(){const e=this.shadowRoot,t=this.getAttribute("search"),o=e.querySelector(".list-container");o.textContent="\u041F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435, \u0438\u0434\u0451\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430...",await M(),T&&(t?this.createPagination():this.updateList())}static get observedAttributes(){return["search","lastPage"]}attributeChangedCallback(e,t,o){e==="search"&&this.updateList(),e==="lastPage"&&this.updatePage()}createPagination(){const e=this.shadowRoot,t=document.createElement("pagination-component");t.setAttribute("page",this.page),t.setAttribute("last",this.lastPage),t.addEventListener("back-to-page",o=>{o.stopPropagation(),this.page>1&&(this.page--,this.updatePage(),this.getBooksPage())}),t.addEventListener("to-next-page",o=>{o.stopPropagation(),this.page!=this.lastPage&&(this.page++,this.updatePage(),this.getBooksPage())}),e.appendChild(t)}updatePage(){const t=this.shadowRoot.querySelector("pagination-component");t.setAttribute("last",this.lastPage),t.setAttribute("page",this.page)}updateList(){const t=this.shadowRoot.querySelector(".list-title"),o=this.getAttribute("title"),i=this.getAttribute("list-type");i==="book"&&(t.textContent=o,this.getBooksPage()),i==="cart"&&(t.textContent=o+` (${B})`,this.getCartPage())}getBooksPage(){const t=this.shadowRoot.querySelector(".list-container"),o=this.getAttribute("search"),i=this.getAttribute("id");o&&(this.search=o),(this.search?Yt(this.search,this.page):Jt()).then(l=>{const p=document.createDocumentFragment();this.lastPage=Math.floor(l.total%10===0?l.total/10:l.total/10+1)||1;const y=l.total;if(t.innerHTML="",y==0){const g=document.createElement("p");g.textContent="Books are not found",p.appendChild(g)}l.books.forEach(g=>{if(g.isbn13!==i){Y(g);const m=document.createElement("book-component");m.setAttribute("id",g.isbn13);const f=x.map(s=>s.bookId).indexOf(g.isbn13);if(f>=0){const s=x[f].count;m.setAttribute("isAdded",!0),m.setAttribute("count",s)}this.search&&m.setAttribute("search",this.search),p.appendChild(m)}}),t.appendChild(p)}).catch(l=>{console.log(l)})}async getCartPage(){const e=this.shadowRoot,t=document.createDocumentFragment(),o=e.querySelector(".list-container"),i=this.getAttribute("id");o.textContent="\u0418\u0434\u0451\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u043E\u0440\u0437\u0438\u043D\u044B...",await M(),await Promise.all(x.map(async a=>{await it(a.bookId).then(l=>{if(l.isbn13!==i){Y(l);const p=document.createElement("book-component");T&&(p.setAttribute("id",a.bookId),p.setAttribute("isAdded",!0),p.setAttribute("count",a.count),p.setAttribute("ifCart",!0)),t.appendChild(p)}}).catch(l=>{console.log(l)})})),o.innerHTML="",o.appendChild(t),B||(o.textContent="Cart is empty")}}customElements.define("list-component",Wt);class Qt extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"}),t=document.createElement("p");t.setAttribute("class","book-price");const o=document.createElement("div");o.setAttribute("class","cart-button-container"),e.appendChild(t),e.appendChild(o)}connectedCallback(){const e=this.shadowRoot,t=e.querySelector(".book-price"),o=e.querySelector(".cart-button-container"),i=this.getAttribute("isAdded")||!1;let a=this.getAttribute("count");const l=this.getAttribute("id"),p=this.getAttribute("ifCart")||!1,y=this.getAttribute("price");if(p==="true"){const g=y.slice(1);t.textContent=`$${(+g*+a).toFixed(2)}`}else t.textContent=y;if(i==="true"){const g=x.map(r=>r.bookId).indexOf(l),m=x[g].id;o.innerHTML=`<button class="button-minus">-</button>
                <span>${a}</span>
                <button class="button-plus">+</button>`,o.querySelector(".button-minus").addEventListener("click",r=>{if(r.stopPropagation(),a--,a>0)X(m,{bookId:l,count:a}),this.setAttribute("count",a);else{const c={bookId:l,count:a+1};this.deleteFrom(m,c,a)}}),o.querySelector(".button-plus").addEventListener("click",r=>{r.stopPropagation(),a++,X(m,{bookId:l,count:a}),this.setAttribute("count",a)})}else o.innerHTML='<button class="add-to-cart-button">Add To Cart</button>',o.querySelector(".add-to-cart-button").addEventListener("click",m=>{m.stopPropagation(),a=1,this.addTo(l,a)})}async addTo(e,t){await Ft({bookId:e,count:t}),await M(),this.setAttribute("isAdded",!0),this.setAttribute("count",t)}async deleteFrom(e,t){await Ht(e,t),await M(),this.setAttribute("isAdded",!1),this.setAttribute("count",0)}static get observedAttributes(){return["isAdded","count"]}attributeChangedCallback(e,t,o){this.connectedCallback()}}customElements.define("cart-button",Qt);class Xt extends HTMLElement{constructor(){super(),this.page=1,this.last=1;const e=this.attachShadow({mode:"open"}),t=document.createElement("div");t.setAttribute("class","pagination");const o=document.createElement("button");o.setAttribute("class","pagination__prev-btn"),o.textContent="Prev",o.addEventListener("click",p=>{if(p.stopPropagation(),this.page>1){const y=new CustomEvent("back-to-page");this.dispatchEvent(y)}});const i=document.createElement("button");i.setAttribute("class","pagination__next-btn"),i.textContent="Next",i.addEventListener("click",p=>{if(p.stopPropagation(),this.page!=this.last){const y=new CustomEvent("to-next-page");this.dispatchEvent(y)}});const a=document.createElement("span");a.setAttribute("class","pagination__number"),a.innerText=`${this.page}/${this.last}`;const l=document.createElement("style");l.textContent=`
            .pagination__number {
                margin: 0 10px;
            }
        `,t.appendChild(o),t.appendChild(a),t.appendChild(i),e.appendChild(l),e.appendChild(t)}connectedCallback(){const e=this.shadowRoot,t=e.querySelector(".pagination__next-btn"),o=e.querySelector(".pagination__prev-btn"),i=e.querySelector(".pagination__number");this.page==1?o.setAttribute("disabled",!0):o.removeAttribute("disabled"),this.page==this.last?t.setAttribute("disabled",!0):t.removeAttribute("disabled"),i.innerText=`${this.page}/${this.last}`}static get observedAttributes(){return["page","last"]}attributeChangedCallback(e,t,o){e==="page"&&(this.page=o),e==="last"&&(this.last=o),this.connectedCallback(o)}}customElements.define("pagination-component",Xt);Ot();export{te as __vite_legacy_guard};
